<!DOCTYPE html>
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title><%= Settings.product_name %></title>
  <%= stylesheet_link_tag    "application" %>
  <%= javascript_include_tag "application" %>
  <script type="text/javascript" src="https://js.stripe.com/v2/"></script>
</head>
<!--[if lt IE 9 ]><body class="lt-ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <body><!--<![endif]-->
<%= render partial: 'shared/header' %>
<%= yield %>
<%= render partial: 'shared/footer' %>
</body>
<script type="text/javascript">
    // This identifies your website in the createToken call below
    Stripe.setPublishableKey('pk_test_q4ZNLiQWrYZTs3pxKSMxuJ6f');
    // ...

    // Payment
    $(document).on('submit', '#new_order', function(){
        var $form = $(this);
        $form.find('.place-order').prop('disabled', true);

        if(address_validation()){
            Stripe.card.createToken({
                number: $('.card-number').val(),
                cvc: $('.card-cvc').val(),
                exp_month: $('.card-expiry-month').val(),
                exp_year: $('.card-expiry-year').val()
            }, stripeResponseHandler);
        }
        $form.find('.payment_submit').prop('disabled', false);
        return false;
    });
</script>
</html>
